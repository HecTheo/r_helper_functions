fig2_5
fig2_r_sub = ggplot(aes(y = accuracy
, x = n
, colour = as.factor(x)
, shape = as.factor(method)
, linetype = as.factor(x))
, data = subset(data_sub, method %in% c('None-LOO', 'None-Holdout', 'None-Ind. sample'))
, stat="identity") +
scale_x_discrete(limits=seq(0, max(data_sub$n), 1000), expand = c(.03, .01))  +
scale_y_continuous(limits = c(-0.10, 0.50), breaks=seq(-0.1, 0.50, 0.05)) +
labs(y = "Accuracy delta\n", x = "\n n") +
# scale_colour_grey(start = 0.1, end = 0.6)+
geom_segment(x = data_sub$n[pos1_5+1]
, xend = data_sub$n[pos1_5+1]
, y=-Inf
, yend=0.20
, color = 'black'
, size=.3
, linetype=2
, show.legend = F) +
geom_segment(x = data_sub$n[pos1_8+1]
, xend = data_sub$n[pos1_8+1]
, y=-Inf
, yend=0.10
, color = 'black'
, size=.3
, linetype=2
, show.legend = F) +
geom_segment(x = data_sub$n[pos1_19+1]
, xend = data_sub$n[pos1_19+1]
, y=-Inf
, yend=0.075
, color = 'black'
, size=.3
, linetype=2
, show.legend = F) +
geom_hline(yintercept=upper_poc
, linetype=3
, color="black") +
geom_hline(yintercept=lower_poc,
linetype=3,
color="black") +
geom_hline(yintercept=0,
linetype=2,
color="black") +
geom_point(alpha = 0.5, size=1.25, show.legend = F) +
geom_smooth(se=F, span = 0.1, method = 'loess') +
#theme_bw() +
theme(legend.direction="horizontal",
legend.title=element_blank()
, legend.position=c(.2, .95)
, legend.text=element_text(size=10)
#plot.background = element_rect(fill = "transparent"),
#, panel.background = element_rect(fill = "gray80")
, panel.grid.major = element_line(colour = "gray95")
#axis.title.y=element_text(margin=margin(0,20,0,0))
#plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm")
)
# +
#   annotate("text"
#            , x = data$n[pos_delta_normal_loocv+1]+200
#            , y = .22
#            , size = 3
#            , label = paste("POS 1: n =", data$n[pos_delta_normal_loocv+1], sep=" ")
#            , angle = 45) +
#   annotate("text"
#            , x = data$n[pos_delta_normal_tt+1]+200
#            , size = 3
#            , y = .12
#            , label = paste("POS 2: n =", data$n[pos_delta_normal_tt+1], sep=" ")
#            , angle = 45) +
#   annotate("text"
#            , x = data$n[pos_delta_normal_t_newsample+1]+200
#            , size = 3
#            , y = .095
#            , label = paste("POS 3: n =", data$n[pos_delta_normal_t_newsample+1], sep=" ")
#            , angle = 45) +
#   annotate("text"
#            , x = 4200
#            , y = .032
#            , size = 3
#            , label = 'Stability corridor (upper)'
#            , angle = 0) +
#   annotate("text"
#            , x = 4200
#            , y = -.032
#            , size = 3
#            , label = 'Stability corridor (lower)'
#            , angle = 0) +
#   geom_rect(data=data
#             , aes(xmin=40, xmax=200, ymin=-.05, ymax=.32)
#             , fill = NA
#             , color="gray60", alpha=0.1, inherit.aes = FALSE) +
#   geom_segment(x = 200
#                , xend = 2500
#                , y=.32
#                , yend=.32
#                , color = 'black'
#                , size=.3
#                , linetype=2
#                , show.legend = F) +
#   geom_segment(x = 200
#                , xend = 2500
#                , y=-.05
#                , yend=.15
#                , color = 'black'
#                , size=.3
#                , linetype=2
#                , show.legend = F)
fig2_r_sub
########################################################
### ANALYSE DATA FOR COMPARATIVE LINGUISTIC ANALYSIS ###
########################################################
rm(list = ls())
#set wd
setwd('/Users/bennettkleinberg/Documents/Research/CBDMI_Schiphol/michigan/comparative_paper/data/final')
load('final_data__rdb_liwc_ne_comparative_analysis_michigan_25102017.RData')
names(data_full)
########################################################
### ANALYSE DATA FOR COMPARATIVE LINGUISTIC ANALYSIS ###
########################################################
rm(list = ls())
#set wd
setwd('/Users/bennettkleinberg/Documents/Research/CBDMI_Schiphol/michigan/comparative_paper/data/final')
#load deps
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/cohensf.R')
load('final_data__rdb_liwc_ne_comparative_analysis_michigan_25102017.RData')
names(data_full)
aggr_table = round(tapply(data_full$insight
, list(data_full$veracity)
, mean)
, 2)
aggr_table
summ_aov = summary(aov(data_full$insight ~ data_full$veracity))
summ_aov
summ_aov[[1]]
summ_aov[[1]][["F value"]]
summ_aov[[1]][["Df"]]
aggr_table = round(tapply(data_full$insight
, list(data_full$veracity)
, mean)
, 2)
summ_aov = summary(aov(data_full$insight ~ data_full$veracity))
F_value = summ_aov[[1]][["F value"]][1]
df_num = summ_aov[[1]][["Df"]][1]
df_den = summ_aov[[1]][["Df"]][2]
effect_size = cohensf(F_value, df_num, df_den)
effect_size
anova_col = function(targetcol, indepvar){
aggr_table = round(tapply(targetcol, list(indepvar), mean), 2)
summ_aov = summary(aov(targetcol ~ indepvar))
F_value = summ_aov[[1]][["F value"]][1]
df_num = summ_aov[[1]][["Df"]][1]
df_den = summ_aov[[1]][["Df"]][2]
effect_size = cohensf(F_value, df_num, df_den)
return(list(aggr_table, summ_aov, effect_size))
}
apply(data_full[,c(6:10)], 2, function(x){
anova_col(targetcol = x
, indepvar = data_full$veracity)
}
)
names(data_full)
apply(data_full[,c(9:15)], 2, function(x){
anova_col(targetcol = x
, indepvar = data_full$veracity)
})
########################################################
### ANALYSE DATA FOR COMPARATIVE LINGUISTIC ANALYSIS ###
########################################################
rm(list = ls())
#set wd
setwd('/Users/bennettkleinberg/Documents/Research/CBDMI_Schiphol/michigan/comparative_paper/data/final')
#load deps
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/cohensf.R')
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/anova_col.R')
load('final_data__rdb_liwc_ne_comparative_analysis_michigan_25102017.RData')
apply(data_full[,c(9:15)], 2, function(x){
anova_col(targetcol = x
, indepvar = data_full$veracity)
})
########################################################
### ANALYSE DATA FOR COMPARATIVE LINGUISTIC ANALYSIS ###
########################################################
rm(list = ls())
#set wd
setwd('/Users/bennettkleinberg/Documents/Research/CBDMI_Schiphol/michigan/comparative_paper/data/final')
#load deps
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/cohensf.R')
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/anova_col.R')
load('final_data__rdb_liwc_ne_comparative_analysis_michigan_25102017.RData')
names(data_full)
apply(data_full[,c(9:15)], 2, function(x){
anova_col(targetcol = x
, indepvar = data_full$veracity)
})
sapply(data_full[,c(9:15)], 2, function(x){
anova_col(targetcol = x
, indepvar = data_full$veracity)
})
sapply(data_full[,c(9:15)], function(x){
anova_col(targetcol = x
, indepvar = data_full$veracity)
})
data_full[,c(9:15)]
anova_col(targetcol = data_full$Authentic
, indepvar = data_full$veracity)
########################################################
### ANALYSE DATA FOR COMPARATIVE LINGUISTIC ANALYSIS ###
########################################################
rm(list = ls())
#set wd
setwd('/Users/bennettkleinberg/Documents/Research/CBDMI_Schiphol/michigan/comparative_paper/data/final')
#load deps
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/cohensf.R')
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/anova_col.R')
load('final_data__rdb_liwc_ne_comparative_analysis_michigan_25102017.RData')
names(data_full)
sapply(data_full[,c(9:15)], function(x){
anova_col(targetcol = x
, indepvar = data_full$veracity)
})
anova_col(targetcol = data_full$Authentic
, indepvar = data_full$veracity)
anova_col(targetcol = data_full$Authentic
, indepvar = data_full$veracity)
########################################################
### ANALYSE DATA FOR COMPARATIVE LINGUISTIC ANALYSIS ###
########################################################
rm(list = ls())
#set wd
setwd('/Users/bennettkleinberg/Documents/Research/CBDMI_Schiphol/michigan/comparative_paper/data/final')
#load deps
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/cohensf.R')
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/anova_col.R')
load('final_data__rdb_liwc_ne_comparative_analysis_michigan_25102017.RData')
names(data_full)
########################################################
### ANALYSE DATA FOR COMPARATIVE LINGUISTIC ANALYSIS ###
########################################################
rm(list = ls())
#set wd
setwd('/Users/bennettkleinberg/Documents/Research/CBDMI_Schiphol/michigan/comparative_paper/data/final')
#load deps
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/anova_col.R')
load('final_data__rdb_liwc_ne_comparative_analysis_michigan_25102017.RData')
anova_col(targetcol = data_full$Authentic
, indepvar = data_full$veracity)
########################################################
### ANALYSE DATA FOR COMPARATIVE LINGUISTIC ANALYSIS ###
########################################################
rm(list = ls())
#set wd
setwd('/Users/bennettkleinberg/Documents/Research/CBDMI_Schiphol/michigan/comparative_paper/data/final')
#load deps
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/anova_col.R')
load('final_data__rdb_liwc_ne_comparative_analysis_michigan_25102017.RData')
names(data_full)
sapply(data_full[,c(9:15)], function(x){
anova_col(targetcol = x
, indepvar = data_full$veracity)
})
anova_col(targetcol = data_full$Authentic
, indepvar = data_full$veracity)
########################################################
### ANALYSE DATA FOR COMPARATIVE LINGUISTIC ANALYSIS ###
########################################################
rm(list = ls())
#set wd
setwd('/Users/bennettkleinberg/Documents/Research/CBDMI_Schiphol/michigan/comparative_paper/data/final')
#load deps
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/anova_col.R')
load('final_data__rdb_liwc_ne_comparative_analysis_michigan_25102017.RData')
anova_col(targetcol = data_full$Authentic
, indepvar = data_full$veracity)
########################################################
### ANALYSE DATA FOR COMPARATIVE LINGUISTIC ANALYSIS ###
########################################################
rm(list = ls())
#set wd
setwd('/Users/bennettkleinberg/Documents/Research/CBDMI_Schiphol/michigan/comparative_paper/data/final')
#load deps
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/anova_col.R')
load('final_data__rdb_liwc_ne_comparative_analysis_michigan_25102017.RData')
names(data_full)
anova_col(targetcol = data_full$Authentic
, indepvar = data_full$veracity)
########################################################
### ANALYSE DATA FOR COMPARATIVE LINGUISTIC ANALYSIS ###
########################################################
rm(list = ls())
#set wd
setwd('/Users/bennettkleinberg/Documents/Research/CBDMI_Schiphol/michigan/comparative_paper/data/final')
#load deps
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/anova_col.R')
load('final_data__rdb_liwc_ne_comparative_analysis_michigan_25102017.RData')
names(data_full)
anova_col(targetcol = data_full$Authentic
, indepvar = data_full$veracity)
apply(data_full[,5:20], 2, function(x){
print(x)
anova_col(targetcol = x
, indepvar = data_full$veracity)
})
apply(data_full[,15:20], 2, function(x){
print(x)
anova_col(targetcol = x
, indepvar = data_full$veracity)
})
apply(data_full[,15:20], 2, function(x){
#print(x) # get colname
anova_col(targetcol = x
, indepvar = data_full$veracity)
})
str(data_full$text_n_fac)
summary(data_full$text_n_fac)
apply(data_full[,20:30], 2, function(x){
#print(x) # get colname
anova_col(targetcol = x
, indepvar = data_full$veracity)
})
apply(data_full[,40:50], 2, function(x){
#print(x) # get colname
anova_col(targetcol = x
, indepvar = data_full$veracity)
})
summ_aov
aggr_table = round(tapply(data_full$you, list(data_full$veracity), mean), 2)
aggr_table
summ_aov = summary(aov(data_full$you ~ data_full$veracity))
summ_aov[[1]]
summ_aov[[1]]
summ_aov[[1]][["Pr(>F)"]]
round(summ_aov[[1]][["Pr(>F)"]][1], 3)
########################################################
### ANALYSE DATA FOR COMPARATIVE LINGUISTIC ANALYSIS ###
########################################################
rm(list = ls())
#set wd
setwd('/Users/bennettkleinberg/Documents/Research/CBDMI_Schiphol/michigan/comparative_paper/data/final')
#load deps
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/anova_col.R')
load('final_data__rdb_liwc_ne_comparative_analysis_michigan_25102017.RData')
names(data_full)
anova_col(targetcol = data_full$Authentic
, indepvar = data_full$veracity)
apply(data_full[,40:50], 2, function(x){
#print(x) # get colname
anova_col(targetcol = x
, indepvar = data_full$veracity)
})
apply(data_full[,15:20], 2, function(x){
#print(x) # get colname
anova_col(targetcol = x
, indepvar = data_full$veracity)
})
########################################################
### ANALYSE DATA FOR COMPARATIVE LINGUISTIC ANALYSIS ###
########################################################
rm(list = ls())
#set wd
setwd('/Users/bennettkleinberg/Documents/Research/CBDMI_Schiphol/michigan/comparative_paper/data/final')
#load deps
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/anova_col.R')
load('final_data__rdb_liwc_ne_comparative_analysis_michigan_25102017.RData')
names(data_full)
apply(data_full[,15:20], 2, function(x){
#print(x) # get colname
anova_col(targetcol = x
, indepvar = data_full$veracity)
})
apply(data_full[,40:55], 2, function(x){
#print(x) # get colname
anova_col(targetcol = x
, indepvar = data_full$veracity)
})
########################################################
### ANALYSE DATA FOR COMPARATIVE LINGUISTIC ANALYSIS ###
########################################################
rm(list = ls())
#set wd
setwd('/Users/bennettkleinberg/Documents/Research/CBDMI_Schiphol/michigan/comparative_paper/data/final')
#load deps
source('/Users/bennettkleinberg/Documents/Research/analysis/R_script/anova_col.R')
load('final_data__rdb_liwc_ne_comparative_analysis_michigan_25102017.RData')
names(data_full)
apply(data_full[,40:55], 2, function(x){
#print(x) # get colname
anova_col(targetcol = x
, indepvar = data_full$veracity
, 't')
})
data_full$i
tapply(data_full$i,
list(data_full$veracity
, data_full$prodmod
, data_full$source
, data_full$topic), mean)
tapply(data_full$i,
list(data_full$veracity
, data_full$prodmod
#, data_full$source
, data_full$topic), mean)
tapply(data_full$i,
list(data_full$veracity
, data_full$prodmod
#, data_full$source
#, data_full$topic
), mean)
tapply(data_full$text_n_date,
list(data_full$veracity
, data_full$prodmod
#, data_full$source
#, data_full$topic
), mean)
tapply(data_full$rdb_fleschkincaid,
list(data_full$veracity
, data_full$prodmod
#, data_full$source
#, data_full$topic
), mean)
levels(data_full$prodmod)
levels(as.factor(data_full$prodmod))
levels(as.factor(data_full$prodmod)) = c('spoken', 'written', 'written')
data_full$prodmod = as.factor(data_full$prodmod)
levels(data_full$prodmod) = c('spoken', 'written', 'written')
tapply(data_full$rdb_fleschkincaid,
list(data_full$veracity
, data_full$prodmod
#, data_full$source
#, data_full$topic
), mean)
tapply(data_full$time,
list(data_full$veracity
, data_full$prodmod
#, data_full$source
#, data_full$topic
), mean)
tapply(data_full$time,
list(data_full$veracity
, data_full$prodmod
#, data_full$source
, data_full$topic
), mean)
data_full$topic = as.factor(data_full$topic)
levels(data_full$topic)
data_full$source = as.factor(data_full$source)
levels(data_full$source)
###########################################################
### DEMO ResMas 20172018
### - named entity extraction with spacy-to-r brigde
### - part-of-speech extraction ~
### - calculate readability of statements
###########################################################
rm(list = ls())
#set wd
setwd('/Users/bennettkleinberg/GitHub/r_helper_functions')
#code at: https://github.com/ben-aaron188/r_helper_functions
# load dependencies
source('txt_df_from_dir.R') #bunch-load txt files from directory
source('get_single_readability.R') # extract indiv readability from string col.
#!! needs spacy python dependency local !! #
source('spacy_ner_r.R') # extract NEs from string column
source('spacy_pos_r.R') # extract POS from string column
data = txt_df_from_dir(dirpath = '/Users/bennettkleinberg/Documents/Research/outputfiles/ms_language/single_texts/english')
View(data)
data$person_references_nonunique = get_entity_count(df_identifier = data$Filename
, df_textcol = data$text
, unique_extr = F
, entity_type = 'person')
###########################################################
### DEMO ResMas 20172018
### - named entity extraction with spacy-to-r brigde
### - part-of-speech extraction ~
### - calculate readability of statements
###########################################################
rm(list = ls())
###########################################################
### DEMO ResMas 20172018
### - named entity extraction with spacy-to-r brigde
### - part-of-speech extraction ~
### - calculate readability of statements
###########################################################
rm(list = ls())
rm(list = ls())
#set wd
setwd('/Users/bennettkleinberg/GitHub/r_helper_functions')
#code at: https://github.com/ben-aaron188/r_helper_functions
source('txt_df_from_dir.R') #bunch-load txt files from directory
source('get_single_readability.R') # extract indiv readability from string col.
#!! needs spacy python dependency local !! #
source('spacy_ner_r.R') # extract NEs from string column
source('spacy_pos_r.R') # extract POS from string column
#1. load individual text files into dataframe as string column
data = txt_df_from_dir(dirpath = '/Users/bennettkleinberg/Documents/Research/outputfiles/ms_language/single_texts/english')
View(data)
#2. calculate readability (see documentation in source code)
data$rdb_fleschkincaid = get_single_readability(data$text, 'Flesch_Kincaid')
#... can do 6 readability indices in total
View(data)
data$person_references_nonunique = get_entity_count(df_identifier = data$Filename
, df_textcol = data$text
, unique_extr = F
, entity_type = 'person')
data$pos_adj_nonunique = get_pos_count(df_identifier = data$Filename
, df_textcol = data$text
, unique_extr = F
, pos_type = 'ADJ')
#... can do 17 NEs in total
View(data)
grades4 = read.spss('/Users/bennettkleinberg/Documents/Research/UVA/teaching/deception_lie_detection/20172018/grades/Grades essay questions.sav', to.data.frame = T)
View(grades4)
